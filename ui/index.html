<!DOCTYPE html>
<html>

<head>
  <title>Blacksmith Management Console</title>
  <link rel="stylesheet" type="text/css" href="/blacksmith.css?v=20250119">
  <link rel="stylesheet" type="text/css" href="/xterm.css">
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
</head>

<body>

  <header>
    <div class="wrap">
      <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme">
        <svg id="themeIcon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
          <!-- Sun icon (light mode) -->
          <path class="sun-icon" d="M12 17.5C9.5 17.5 7.5 15.5 7.5 13S9.5 8.5 12 8.5 16.5 10.5 16.5 13 14.5 17.5 12 17.5M12 7C8.7 7 6 9.7 6 13S8.7 19 12 19 18 16.3 18 13 15.3 7 12 7M12 2L14.4 6.4L19 5.7L16.2 9.8L18.6 14L14 12.6L10 15L11.4 10.4L7.2 8L11.8 5.6L12 2M3.3 7L7.7 5.6L5.6 9.7L3.3 7M7.7 18.4L3.3 17L5.6 14.3L7.7 18.4M16.3 14.3L18.4 17L14 18.4L16.3 14.3M18.4 7L16.3 9.7L14 5.6L18.4 7Z" style="display: block;"/>
          <!-- Moon icon (dark mode) -->
          <path class="moon-icon" d="M17.75,4.09L15.22,6.03L16.13,9.09L13.5,7.28L10.87,9.09L11.78,6.03L9.25,4.09L12.44,4L13.5,1L14.56,4L17.75,4.09M21.25,11L19.61,12.25L20.2,14.23L18.5,13.06L16.8,14.23L17.39,12.25L15.75,11L17.81,10.95L18.5,9L19.19,10.95L21.25,11M18.97,15.95C19.8,15.87 20.69,17.05 20.16,17.8C19.84,18.25 19.5,18.67 19.08,19.07C15.17,23 8.84,23 4.94,19.07C1.03,15.17 1.03,8.83 4.94,4.93C5.34,4.53 5.76,4.17 6.21,3.85C6.96,3.32 8.14,4.21 8.06,5.04C7.79,7.9 8.75,10.87 10.95,13.06C13.14,15.26 16.1,16.22 18.97,15.95M17.33,17.97C14.5,17.81 11.7,16.64 9.53,14.5C7.36,12.31 6.2,9.5 6.04,6.68C3.23,9.82 3.34,14.64 6.35,17.66C9.37,20.67 14.19,20.78 17.33,17.97Z" style="display: none;"/>
        </svg>
        <span id="themeText">Dark</span>
      </button>
      <span id="logo">
        <img src="/blacksmith.svg" alt="Blacksmith" style="height: 32px; width: 32px; vertical-align: middle; margin-right: 8px;">
        Blacksmith
      </span>
      <span id="deployment-name"></span>
      <span id="ident"></span>
    </div>
  </header>

  <!-- Minimized Terminal Bar -->
  <div id="minimized-terminal-bar" class="minimized-terminal-bar">
    <div class="left-section">
      <img src="/blacksmith.svg" alt="Blacksmith" style="height: 20px; width: 20px;">
      <div class="minimized-terminal-tabs" id="minimized-terminal-tabs"></div>
    </div>
    <div class="right-section">
      <button class="terminal-control-btn" title="Restore Terminal" onclick="window.TerminalManager && window.TerminalManager.restoreAll()">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M8 3H5a2 2 0 0 0-2 2v3m18-3v3a2 2 0 0 1-2 2h-3m0 8h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"/>
        </svg>
      </button>
      <button class="terminal-control-btn" title="Close All Terminals" onclick="window.TerminalManager && window.TerminalManager.closeAll()">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="18" y1="6" x2="6" y2="18"/>
          <line x1="6" y1="6" x2="18" y2="18"/>
        </svg>
      </button>
    </div>
  </div>

  <div class="main-content">
    <div class="wrap">
      <!-- Tab navigation -->
      <div class="tabs" role="tablist" aria-label="Main navigation">
        <button class="tab-button active" data-tab="blacksmith" role="tab" aria-selected="true"
          aria-controls="blacksmith">Blacksmith</button>
        <button class="tab-button" data-tab="plans" role="tab" aria-selected="false"
          aria-controls="plans">Plans</button>
        <button class="tab-button" data-tab="services" role="tab" aria-selected="false" aria-controls="services">Service
          Instances</button>
      </div>

      <!-- Tab content panels -->
      <div class="tab-content">
        <div id="blacksmith" class="tab-panel active" role="tabpanel" aria-hidden="false">
          <!-- Blacksmith sub-tabs -->
          <div class="detail-tabs">
            <button class="detail-tab active" data-tab="details">Details</button>
            <button class="detail-tab" data-tab="events">Events</button>
            <button class="detail-tab" data-tab="blacksmith-logs">Logs</button>
            <button class="detail-tab" data-tab="vms">VMs</button>
            <button class="detail-tab" data-tab="logs">Deployment Logs</button>
            <button class="detail-tab" data-tab="debug">Debug Log</button>
            <button class="detail-tab" data-tab="broker">Broker</button>
          </div>
          
          <!-- Blacksmith detail content -->
          <div class="detail-content">
            <div class="loading" style="padding: 2em; text-align: center;">loading, please wait...</div>
          </div>
        </div>

        <div id="plans" class="tab-panel" role="tabpanel" aria-hidden="true">
          <div class="loading" style="padding: 2em; text-align: center;">loading, please wait...</div>
        </div>

        <div id="services" class="tab-panel" role="tabpanel" aria-hidden="true">
          <div class="loading" style="padding: 2em; text-align: center;">loading, please wait...</div>
        </div>

      </div>
    </div>
  </div>

  <footer>
    <div class="wrap">
      <p>
        <img src="/blacksmith.svg" alt="Blacksmith" style="height: 20px; width: 20px; vertical-align: middle; margin-right: 4px;">
        Copyright &copy; 2025 Blacksmith Community
      </p>
    </div>
  </footer>

  <!-- CF Registration Modal -->
  <div id="registration-modal" class="modal" style="display: none;" role="dialog" aria-labelledby="registration-modal-title" aria-hidden="true">
    <div class="modal-content">
      <div class="modal-header">
        <h3 id="registration-modal-title">New CF Registration</h3>
        <button class="modal-close" aria-label="Close modal">&times;</button>
      </div>
      <div class="modal-body">
        <form id="registration-form">
          <div class="form-group">
            <label for="reg-name">Registration Name:</label>
            <input type="text" id="reg-name" name="name" required>
            <small>Friendly name for this registration</small>
          </div>
          
          <div class="form-group">
            <label for="reg-api-url">CF API URL:</label>
            <input type="url" id="reg-api-url" name="api_url" required placeholder="https://api.cf.example.com">
            <small>Cloud Foundry API endpoint URL</small>
          </div>
          
          <div class="form-group">
            <label for="reg-username">Username:</label>
            <input type="text" id="reg-username" name="username" required>
            <small>CF user with admin privileges</small>
          </div>
          
          <div class="form-group">
            <label for="reg-password">Password:</label>
            <input type="password" id="reg-password" name="password" required>
            <small>CF user password</small>
          </div>
          
          <div class="form-group">
            <label for="reg-broker-name">Broker Name:</label>
            <input type="text" id="reg-broker-name" name="broker_name" placeholder="blacksmith">
            <small>Name for the service broker in CF (optional)</small>
          </div>
          
          <div class="form-group">
            <label class="checkbox-label">
              <input type="checkbox" id="reg-auto-register" name="auto_register">
              <span class="checkmark"></span>
              Auto-register immediately
            </label>
            <small>Start registration process immediately after creation</small>
          </div>
        </form>
        
        <div id="registration-progress" class="progress-container" style="display: none;">
          <div class="progress-header">
            <h4>Registration Progress</h4>
          </div>
          <div class="progress-steps">
            <div class="progress-step" id="step-validating">
              <div class="step-icon"></div>
              <div class="step-content">
                <div class="step-title">Validating</div>
                <div class="step-message">Validating registration request</div>
              </div>
            </div>
            <div class="progress-step" id="step-connecting">
              <div class="step-icon"></div>
              <div class="step-content">
                <div class="step-title">Connecting</div>
                <div class="step-message">Connecting to Cloud Foundry</div>
              </div>
            </div>
            <div class="progress-step" id="step-authenticating">
              <div class="step-icon"></div>
              <div class="step-content">
                <div class="step-title">Authenticating</div>
                <div class="step-message">Authenticating with Cloud Foundry</div>
              </div>
            </div>
            <div class="progress-step" id="step-creating-broker">
              <div class="step-icon"></div>
              <div class="step-content">
                <div class="step-title">Creating Broker</div>
                <div class="step-message">Creating service broker</div>
              </div>
            </div>
            <div class="progress-step" id="step-enabling-services">
              <div class="step-icon"></div>
              <div class="step-content">
                <div class="step-title">Enabling Services</div>
                <div class="step-message">Enabling service access</div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" id="cancel-registration">Cancel</button>
        <button type="button" class="btn btn-primary" id="test-connection-btn">Test Connection</button>
        <button type="submit" class="btn btn-success" id="save-registration-btn" form="registration-form">Save Registration</button>
      </div>
    </div>
  </div>

  <!-- Terminal Modal -->
  <div id="terminal-modal" class="modal-overlay" style="display: none;">
    <div class="modal terminal-modal-content">
      <div class="modal-header terminal-header">
        <h2>SSH Terminal</h2>
        <div class="terminal-header-controls">
          <button class="terminal-control-btn" id="reconnect-btn" title="Reconnect" onclick="window.TerminalManager && window.TerminalManager.reconnectActive()">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"/>
            </svg>
          </button>
          <button class="terminal-control-btn" id="minimize-btn" title="Minimize" onclick="window.TerminalManager && window.TerminalManager.minimizeAll()">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="6" y1="19" x2="18" y2="19"/>
            </svg>
          </button>
          <button class="modal-close" onclick="window.TerminalManager && window.TerminalManager.closeAll()">&times;</button>
        </div>
      </div>
      <div class="terminal-tabs" id="terminal-tabs"></div>
      <div class="terminal-container" id="terminal-container"></div>
    </div>
  </div>

  <script type="text/javascript" src="/xterm.min.js"></script>
  <script type="text/javascript" src="/blacksmith.js?v=20250119"></script>
</body>

</html>
